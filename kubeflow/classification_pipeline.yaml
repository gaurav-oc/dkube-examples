apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: complaint-model-pipeline-kubeflow-
spec:
  arguments:
    parameters: []
  entrypoint: complaint-model-pipeline-kubeflow
  serviceAccountName: pipeline-runner
  templates:
    - dag:
        tasks:
          - name: csvexamplegen
            template: csvexamplegen
          - dependencies:
              - csvexamplegen
              - trainer
            name: evaluator
            template: evaluator
          - dependencies:
              - schemagen
              - statisticsgen
            name: examplevalidator
            template: examplevalidator
          - dependencies:
              - csvexamplegen
              - trainer
            name: modelvalidator
            template: modelvalidator
          - dependencies:
              - modelvalidator
              - trainer
            name: pusher
            template: pusher
          - dependencies:
              - statisticsgen
            name: schemagen
            template: schemagen
          - dependencies:
              - csvexamplegen
            name: statisticsgen
            template: statisticsgen
          - dependencies:
              - schemagen
              - transform
            name: trainer
            template: trainer
          - dependencies:
              - csvexamplegen
              - schemagen
            name: transform
            template: transform
      name: complaint-model-pipeline-kubeflow
    - container:
        args:
          - '--pipeline_name'
          - complaint_model_pipeline_kubeflow
          - '--pipeline_root'
          - /book-classification/tfx
          - '--kubeflow_metadata_config'
          - |-
            {
              "mysqlDbServiceHost": {
                "environmentVariable": "METADATA_DB_SERVICE_HOST"
              },
              "mysqlDbServicePort": {
                "environmentVariable": "METADATA_DB_SERVICE_PORT"
              },
              "mysqlDbName": {
                "value": "metadb"
              },
              "mysqlDbUser": {
                "value": "root"
              },
              "mysqlDbPassword": {
                "value": "test"
              }
            }
          - '--additional_pipeline_args'
          - >-
            {"beam_pipeline_args": ["--runner=DirectRunner",
            "--experiments=shuffle_mode=auto",
            "--temp_location=/book-classification/tmp"]}
          - '--component_id'
          - CsvExampleGen
          - '--component_type'
          - tfx.components.example_gen.csv_example_gen.component.CsvExampleGen
          - '--driver_class_path'
          - tfx.components.example_gen.driver.Driver
          - '--executor_spec'
          - >-
            {"__class__": "ExecutorClassSpec", "__module__":
            "tfx.components.base.executor_spec", "__tfx_object_type__":
            "jsonable", "executor_class": {"__class__": "Executor",
            "__module__": "tfx.components.example_gen.csv_example_gen.executor",
            "__tfx_object_type__": "class"}}
          - '--inputs'
          - >-
            {"input_base": [{"artifact": {"uri": "/book-classification/data/",
            "properties": {"split": {"stringValue": ""}, "type_name":
            {"stringValue": "ExternalPath"}}}, "artifact_type": {"name":
            "ExternalPath", "properties": {"state": "STRING",
            "producer_component": "STRING", "span": "INT", "pipeline_name":
            "STRING", "split": "STRING", "name": "STRING", "type_name":
            "STRING"}}}]}
          - '--outputs'
          - >-
            {"examples": [{"artifact": {"properties": {"split": {"stringValue":
            "train"}, "producer_component": {"stringValue": "CsvExampleGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "examples"}, "type_name": {"stringValue": "ExamplesPath"}}},
            "artifact_type": {"name": "ExamplesPath", "properties": {"split":
            "STRING", "name": "STRING", "type_name": "STRING", "state":
            "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING"}}}, {"artifact": {"properties":
            {"producer_component": {"stringValue": "CsvExampleGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "examples"}, "type_name": {"stringValue": "ExamplesPath"}, "split":
            {"stringValue": "eval"}}}, "artifact_type": {"name": "ExamplesPath",
            "properties": {"split": "STRING", "name": "STRING", "type_name":
            "STRING", "state": "STRING", "producer_component": "STRING", "span":
            "INT", "pipeline_name": "STRING"}}}]}
          - '--exec_properties'
          - >-
            {"input_config": "{\n  \"splits\": [\n    {\n      \"name\":
            \"single_split\",\n      \"pattern\": \"*\"\n    }\n  ]\n}",
            "output_config": "{\n  \"splitConfig\": {\n    \"splits\": [\n     
            {\n        \"hashBuckets\": 2,\n        \"name\": \"train\"\n     
            },\n      {\n        \"hashBuckets\": 1,\n        \"name\":
            \"eval\"\n      }\n    ]\n  }\n}", "custom_config": null}
        command:
          - python
          - /tfx-src/tfx/orchestration/kubeflow/container_entrypoint.py
        env:
          - name: WORKFLOW_ID
            valueFrom:
              fieldRef:
                fieldPath: 'metadata.labels[''workflows.argoproj.io/workflow'']'
        image: 'tensorflow/tfx:0.14.0'
        volumeMounts:
          - mountPath: /book-classification
            name: book-classification
      name: csvexamplegen
      outputs:
        artifacts:
          - name: mlpipeline-ui-metadata
            path: /mlpipeline-ui-metadata.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-ui-metadata.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
          - name: mlpipeline-metrics
            path: /mlpipeline-metrics.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-metrics.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
    - container:
        args:
          - '--pipeline_name'
          - complaint_model_pipeline_kubeflow
          - '--pipeline_root'
          - /book-classification/tfx
          - '--kubeflow_metadata_config'
          - |-
            {
              "mysqlDbServiceHost": {
                "environmentVariable": "METADATA_DB_SERVICE_HOST"
              },
              "mysqlDbServicePort": {
                "environmentVariable": "METADATA_DB_SERVICE_PORT"
              },
              "mysqlDbName": {
                "value": "metadb"
              },
              "mysqlDbUser": {
                "value": "root"
              },
              "mysqlDbPassword": {
                "value": "test"
              }
            }
          - '--additional_pipeline_args'
          - >-
            {"beam_pipeline_args": ["--runner=DirectRunner",
            "--experiments=shuffle_mode=auto",
            "--temp_location=/book-classification/tmp"]}
          - '--component_id'
          - Evaluator
          - '--component_type'
          - tfx.components.evaluator.component.Evaluator
          - '--driver_class_path'
          - tfx.components.base.base_driver.BaseDriver
          - '--executor_spec'
          - >-
            {"__class__": "ExecutorClassSpec", "__module__":
            "tfx.components.base.executor_spec", "__tfx_object_type__":
            "jsonable", "executor_class": {"__class__": "Executor",
            "__module__": "tfx.components.evaluator.executor",
            "__tfx_object_type__": "class"}}
          - '--inputs'
          - >-
            {"examples": [{"artifact": {"properties": {"split": {"stringValue":
            "train"}, "producer_component": {"stringValue": "CsvExampleGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "examples"}, "type_name": {"stringValue": "ExamplesPath"}}},
            "artifact_type": {"name": "ExamplesPath", "properties": {"split":
            "STRING", "name": "STRING", "type_name": "STRING", "state":
            "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING"}}}, {"artifact": {"properties":
            {"producer_component": {"stringValue": "CsvExampleGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "examples"}, "type_name": {"stringValue": "ExamplesPath"}, "split":
            {"stringValue": "eval"}}}, "artifact_type": {"name": "ExamplesPath",
            "properties": {"split": "STRING", "name": "STRING", "type_name":
            "STRING", "state": "STRING", "producer_component": "STRING", "span":
            "INT", "pipeline_name": "STRING"}}}], "model_exports": [{"artifact":
            {"properties": {"name": {"stringValue": "output"}, "type_name":
            {"stringValue": "ModelExportPath"}, "split": {"stringValue": ""},
            "producer_component": {"stringValue": "Trainer"}, "pipeline_name":
            {"stringValue": "complaint_model_pipeline_kubeflow"}}},
            "artifact_type": {"name": "ModelExportPath", "properties": {"state":
            "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING", "split": "STRING", "name": "STRING",
            "type_name": "STRING"}}}]}
          - '--outputs'
          - >-
            {"output": [{"artifact": {"properties": {"name": {"stringValue":
            "output"}, "type_name": {"stringValue": "ModelEvalPath"}, "split":
            {"stringValue": ""}, "producer_component": {"stringValue":
            "Evaluator"}, "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}}}, "artifact_type": {"name":
            "ModelEvalPath", "properties": {"split": "STRING", "name": "STRING",
            "type_name": "STRING", "state": "STRING", "producer_component":
            "STRING", "span": "INT", "pipeline_name": "STRING"}}}]}
          - '--exec_properties'
          - >-
            {"feature_slicing_spec": "{\n  \"specs\": [\n    {\n     
            \"columnForSlicing\": [\n        \"trip_start_hour\"\n      ]\n   
            }\n  ]\n}"}
        command:
          - python
          - /tfx-src/tfx/orchestration/kubeflow/container_entrypoint.py
        env:
          - name: WORKFLOW_ID
            valueFrom:
              fieldRef:
                fieldPath: 'metadata.labels[''workflows.argoproj.io/workflow'']'
        image: 'tensorflow/tfx:0.14.0'
        volumeMounts:
          - mountPath: /book-classification
            name: book-classification
      name: evaluator
      outputs:
        artifacts:
          - name: mlpipeline-ui-metadata
            path: /mlpipeline-ui-metadata.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-ui-metadata.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
          - name: mlpipeline-metrics
            path: /mlpipeline-metrics.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-metrics.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
    - container:
        args:
          - '--pipeline_name'
          - complaint_model_pipeline_kubeflow
          - '--pipeline_root'
          - /book-classification/tfx
          - '--kubeflow_metadata_config'
          - |-
            {
              "mysqlDbServiceHost": {
                "environmentVariable": "METADATA_DB_SERVICE_HOST"
              },
              "mysqlDbServicePort": {
                "environmentVariable": "METADATA_DB_SERVICE_PORT"
              },
              "mysqlDbName": {
                "value": "metadb"
              },
              "mysqlDbUser": {
                "value": "root"
              },
              "mysqlDbPassword": {
                "value": "test"
              }
            }
          - '--additional_pipeline_args'
          - >-
            {"beam_pipeline_args": ["--runner=DirectRunner",
            "--experiments=shuffle_mode=auto",
            "--temp_location=/book-classification/tmp"]}
          - '--component_id'
          - ExampleValidator
          - '--component_type'
          - tfx.components.example_validator.component.ExampleValidator
          - '--driver_class_path'
          - tfx.components.base.base_driver.BaseDriver
          - '--executor_spec'
          - >-
            {"__class__": "ExecutorClassSpec", "__module__":
            "tfx.components.base.executor_spec", "__tfx_object_type__":
            "jsonable", "executor_class": {"__class__": "Executor",
            "__module__": "tfx.components.example_validator.executor",
            "__tfx_object_type__": "class"}}
          - '--inputs'
          - >-
            {"stats": [{"artifact": {"properties": {"split": {"stringValue":
            "train"}, "producer_component": {"stringValue": "StatisticsGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "output"}, "type_name": {"stringValue": "ExampleStatisticsPath"}}},
            "artifact_type": {"name": "ExampleStatisticsPath", "properties":
            {"state": "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING", "split": "STRING", "name": "STRING",
            "type_name": "STRING"}}}, {"artifact": {"properties":
            {"producer_component": {"stringValue": "StatisticsGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "output"}, "type_name": {"stringValue": "ExampleStatisticsPath"},
            "split": {"stringValue": "eval"}}}, "artifact_type": {"name":
            "ExampleStatisticsPath", "properties": {"name": "STRING",
            "type_name": "STRING", "state": "STRING", "producer_component":
            "STRING", "span": "INT", "pipeline_name": "STRING", "split":
            "STRING"}}}], "schema": [{"artifact": {"properties":
            {"producer_component": {"stringValue": "SchemaGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "output"}, "type_name": {"stringValue": "SchemaPath"}, "split":
            {"stringValue": ""}}}, "artifact_type": {"name": "SchemaPath",
            "properties": {"type_name": "STRING", "state": "STRING",
            "producer_component": "STRING", "span": "INT", "pipeline_name":
            "STRING", "split": "STRING", "name": "STRING"}}}]}
          - '--outputs'
          - >-
            {"output": [{"artifact": {"properties": {"name": {"stringValue":
            "output"}, "type_name": {"stringValue": "ExampleValidationPath"},
            "split": {"stringValue": ""}, "producer_component": {"stringValue":
            "ExampleValidator"}, "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}}}, "artifact_type": {"name":
            "ExampleValidationPath", "properties": {"split": "STRING", "name":
            "STRING", "type_name": "STRING", "state": "STRING",
            "producer_component": "STRING", "span": "INT", "pipeline_name":
            "STRING"}}}]}
          - '--exec_properties'
          - '{}'
        command:
          - python
          - /tfx-src/tfx/orchestration/kubeflow/container_entrypoint.py
        env:
          - name: WORKFLOW_ID
            valueFrom:
              fieldRef:
                fieldPath: 'metadata.labels[''workflows.argoproj.io/workflow'']'
        image: 'tensorflow/tfx:0.14.0'
        volumeMounts:
          - mountPath: /book-classification
            name: book-classification
      name: examplevalidator
      outputs:
        artifacts:
          - name: mlpipeline-ui-metadata
            path: /mlpipeline-ui-metadata.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-ui-metadata.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
          - name: mlpipeline-metrics
            path: /mlpipeline-metrics.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-metrics.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
    - container:
        args:
          - '--pipeline_name'
          - complaint_model_pipeline_kubeflow
          - '--pipeline_root'
          - /book-classification/tfx
          - '--kubeflow_metadata_config'
          - |-
            {
              "mysqlDbServiceHost": {
                "environmentVariable": "METADATA_DB_SERVICE_HOST"
              },
              "mysqlDbServicePort": {
                "environmentVariable": "METADATA_DB_SERVICE_PORT"
              },
              "mysqlDbName": {
                "value": "metadb"
              },
              "mysqlDbUser": {
                "value": "root"
              },
              "mysqlDbPassword": {
                "value": "test"
              }
            }
          - '--additional_pipeline_args'
          - >-
            {"beam_pipeline_args": ["--runner=DirectRunner",
            "--experiments=shuffle_mode=auto",
            "--temp_location=/book-classification/tmp"]}
          - '--component_id'
          - ModelValidator
          - '--component_type'
          - tfx.components.model_validator.component.ModelValidator
          - '--driver_class_path'
          - tfx.components.model_validator.driver.Driver
          - '--executor_spec'
          - >-
            {"__class__": "ExecutorClassSpec", "__module__":
            "tfx.components.base.executor_spec", "__tfx_object_type__":
            "jsonable", "executor_class": {"__class__": "Executor",
            "__module__": "tfx.components.model_validator.executor",
            "__tfx_object_type__": "class"}}
          - '--inputs'
          - >-
            {"examples": [{"artifact": {"properties": {"split": {"stringValue":
            "train"}, "producer_component": {"stringValue": "CsvExampleGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "examples"}, "type_name": {"stringValue": "ExamplesPath"}}},
            "artifact_type": {"name": "ExamplesPath", "properties": {"split":
            "STRING", "name": "STRING", "type_name": "STRING", "state":
            "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING"}}}, {"artifact": {"properties":
            {"producer_component": {"stringValue": "CsvExampleGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "examples"}, "type_name": {"stringValue": "ExamplesPath"}, "split":
            {"stringValue": "eval"}}}, "artifact_type": {"name": "ExamplesPath",
            "properties": {"split": "STRING", "name": "STRING", "type_name":
            "STRING", "state": "STRING", "producer_component": "STRING", "span":
            "INT", "pipeline_name": "STRING"}}}], "model": [{"artifact":
            {"properties": {"name": {"stringValue": "output"}, "type_name":
            {"stringValue": "ModelExportPath"}, "split": {"stringValue": ""},
            "producer_component": {"stringValue": "Trainer"}, "pipeline_name":
            {"stringValue": "complaint_model_pipeline_kubeflow"}}},
            "artifact_type": {"name": "ModelExportPath", "properties": {"state":
            "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING", "split": "STRING", "name": "STRING",
            "type_name": "STRING"}}}]}
          - '--outputs'
          - >-
            {"blessing": [{"artifact": {"properties": {"split": {"stringValue":
            ""}, "producer_component": {"stringValue": "ModelValidator"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "blessing"}, "type_name": {"stringValue": "ModelBlessingPath"}}},
            "artifact_type": {"name": "ModelBlessingPath", "properties":
            {"state": "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING", "split": "STRING", "name": "STRING",
            "type_name": "STRING"}}}]}
          - '--exec_properties'
          - '{}'
        command:
          - python
          - /tfx-src/tfx/orchestration/kubeflow/container_entrypoint.py
        env:
          - name: WORKFLOW_ID
            valueFrom:
              fieldRef:
                fieldPath: 'metadata.labels[''workflows.argoproj.io/workflow'']'
        image: 'tensorflow/tfx:0.14.0'
        volumeMounts:
          - mountPath: /book-classification
            name: book-classification
      name: modelvalidator
      outputs:
        artifacts:
          - name: mlpipeline-ui-metadata
            path: /mlpipeline-ui-metadata.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-ui-metadata.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
          - name: mlpipeline-metrics
            path: /mlpipeline-metrics.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-metrics.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
    - container:
        args:
          - '--pipeline_name'
          - complaint_model_pipeline_kubeflow
          - '--pipeline_root'
          - /book-classification/tfx
          - '--kubeflow_metadata_config'
          - |-
            {
              "mysqlDbServiceHost": {
                "environmentVariable": "METADATA_DB_SERVICE_HOST"
              },
              "mysqlDbServicePort": {
                "environmentVariable": "METADATA_DB_SERVICE_PORT"
              },
              "mysqlDbName": {
                "value": "metadb"
              },
              "mysqlDbUser": {
                "value": "root"
              },
              "mysqlDbPassword": {
                "value": "test"
              }
            }
          - '--additional_pipeline_args'
          - >-
            {"beam_pipeline_args": ["--runner=DirectRunner",
            "--experiments=shuffle_mode=auto",
            "--temp_location=/book-classification/tmp"]}
          - '--component_id'
          - Pusher
          - '--component_type'
          - tfx.components.pusher.component.Pusher
          - '--driver_class_path'
          - tfx.components.base.base_driver.BaseDriver
          - '--executor_spec'
          - >-
            {"__class__": "ExecutorClassSpec", "__module__":
            "tfx.components.base.executor_spec", "__tfx_object_type__":
            "jsonable", "executor_class": {"__class__": "Executor",
            "__module__": "tfx.components.pusher.executor",
            "__tfx_object_type__": "class"}}
          - '--inputs'
          - >-
            {"model_export": [{"artifact": {"properties": {"name":
            {"stringValue": "output"}, "type_name": {"stringValue":
            "ModelExportPath"}, "split": {"stringValue": ""},
            "producer_component": {"stringValue": "Trainer"}, "pipeline_name":
            {"stringValue": "complaint_model_pipeline_kubeflow"}}},
            "artifact_type": {"name": "ModelExportPath", "properties": {"state":
            "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING", "split": "STRING", "name": "STRING",
            "type_name": "STRING"}}}], "model_blessing": [{"artifact":
            {"properties": {"split": {"stringValue": ""}, "producer_component":
            {"stringValue": "ModelValidator"}, "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "blessing"}, "type_name": {"stringValue": "ModelBlessingPath"}}},
            "artifact_type": {"name": "ModelBlessingPath", "properties":
            {"state": "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING", "split": "STRING", "name": "STRING",
            "type_name": "STRING"}}}]}
          - '--outputs'
          - >-
            {"model_push": [{"artifact": {"properties": {"split":
            {"stringValue": ""}, "producer_component": {"stringValue":
            "Pusher"}, "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "model_push"}, "type_name": {"stringValue": "ModelPushPath"}}},
            "artifact_type": {"name": "ModelPushPath", "properties":
            {"producer_component": "STRING", "span": "INT", "pipeline_name":
            "STRING", "split": "STRING", "name": "STRING", "type_name":
            "STRING", "state": "STRING"}}}]}
          - '--exec_properties'
          - >-
            {"push_destination": "{\n  \"filesystem\": {\n    \"baseDirectory\":
            \"/book-classification/serving_model/complaint_model\"\n  }\n}",
            "custom_config": null}
        command:
          - python
          - /tfx-src/tfx/orchestration/kubeflow/container_entrypoint.py
        env:
          - name: WORKFLOW_ID
            valueFrom:
              fieldRef:
                fieldPath: 'metadata.labels[''workflows.argoproj.io/workflow'']'
        image: 'tensorflow/tfx:0.14.0'
        volumeMounts:
          - mountPath: /book-classification
            name: book-classification
      name: pusher
      outputs:
        artifacts:
          - name: mlpipeline-ui-metadata
            path: /mlpipeline-ui-metadata.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-ui-metadata.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
          - name: mlpipeline-metrics
            path: /mlpipeline-metrics.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-metrics.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
    - container:
        args:
          - '--pipeline_name'
          - complaint_model_pipeline_kubeflow
          - '--pipeline_root'
          - /book-classification/tfx
          - '--kubeflow_metadata_config'
          - |-
            {
              "mysqlDbServiceHost": {
                "environmentVariable": "METADATA_DB_SERVICE_HOST"
              },
              "mysqlDbServicePort": {
                "environmentVariable": "METADATA_DB_SERVICE_PORT"
              },
              "mysqlDbName": {
                "value": "metadb"
              },
              "mysqlDbUser": {
                "value": "root"
              },
              "mysqlDbPassword": {
                "value": "test"
              }
            }
          - '--additional_pipeline_args'
          - >-
            {"beam_pipeline_args": ["--runner=DirectRunner",
            "--experiments=shuffle_mode=auto",
            "--temp_location=/book-classification/tmp"]}
          - '--component_id'
          - SchemaGen
          - '--component_type'
          - tfx.components.schema_gen.component.SchemaGen
          - '--driver_class_path'
          - tfx.components.base.base_driver.BaseDriver
          - '--executor_spec'
          - >-
            {"__class__": "ExecutorClassSpec", "__module__":
            "tfx.components.base.executor_spec", "__tfx_object_type__":
            "jsonable", "executor_class": {"__class__": "Executor",
            "__module__": "tfx.components.schema_gen.executor",
            "__tfx_object_type__": "class"}}
          - '--inputs'
          - >-
            {"stats": [{"artifact": {"properties": {"split": {"stringValue":
            "train"}, "producer_component": {"stringValue": "StatisticsGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "output"}, "type_name": {"stringValue": "ExampleStatisticsPath"}}},
            "artifact_type": {"name": "ExampleStatisticsPath", "properties":
            {"state": "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING", "split": "STRING", "name": "STRING",
            "type_name": "STRING"}}}, {"artifact": {"properties":
            {"producer_component": {"stringValue": "StatisticsGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "output"}, "type_name": {"stringValue": "ExampleStatisticsPath"},
            "split": {"stringValue": "eval"}}}, "artifact_type": {"name":
            "ExampleStatisticsPath", "properties": {"name": "STRING",
            "type_name": "STRING", "state": "STRING", "producer_component":
            "STRING", "span": "INT", "pipeline_name": "STRING", "split":
            "STRING"}}}]}
          - '--outputs'
          - >-
            {"output": [{"artifact": {"properties": {"producer_component":
            {"stringValue": "SchemaGen"}, "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "output"}, "type_name": {"stringValue": "SchemaPath"}, "split":
            {"stringValue": ""}}}, "artifact_type": {"name": "SchemaPath",
            "properties": {"type_name": "STRING", "state": "STRING",
            "producer_component": "STRING", "span": "INT", "pipeline_name":
            "STRING", "split": "STRING", "name": "STRING"}}}]}
          - '--exec_properties'
          - '{"infer_feature_shape": false}'
        command:
          - python
          - /tfx-src/tfx/orchestration/kubeflow/container_entrypoint.py
        env:
          - name: WORKFLOW_ID
            valueFrom:
              fieldRef:
                fieldPath: 'metadata.labels[''workflows.argoproj.io/workflow'']'
        image: 'tensorflow/tfx:0.14.0'
        volumeMounts:
          - mountPath: /book-classification
            name: book-classification
      name: schemagen
      outputs:
        artifacts:
          - name: mlpipeline-ui-metadata
            path: /mlpipeline-ui-metadata.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-ui-metadata.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
          - name: mlpipeline-metrics
            path: /mlpipeline-metrics.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-metrics.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
    - container:
        args:
          - '--pipeline_name'
          - complaint_model_pipeline_kubeflow
          - '--pipeline_root'
          - /book-classification/tfx
          - '--kubeflow_metadata_config'
          - |-
            {
              "mysqlDbServiceHost": {
                "environmentVariable": "METADATA_DB_SERVICE_HOST"
              },
              "mysqlDbServicePort": {
                "environmentVariable": "METADATA_DB_SERVICE_PORT"
              },
              "mysqlDbName": {
                "value": "metadb"
              },
              "mysqlDbUser": {
                "value": "root"
              },
              "mysqlDbPassword": {
                "value": "test"
              }
            }
          - '--additional_pipeline_args'
          - >-
            {"beam_pipeline_args": ["--runner=DirectRunner",
            "--experiments=shuffle_mode=auto",
            "--temp_location=/book-classification/tmp"]}
          - '--component_id'
          - StatisticsGen
          - '--component_type'
          - tfx.components.statistics_gen.component.StatisticsGen
          - '--driver_class_path'
          - tfx.components.base.base_driver.BaseDriver
          - '--executor_spec'
          - >-
            {"__class__": "ExecutorClassSpec", "__module__":
            "tfx.components.base.executor_spec", "__tfx_object_type__":
            "jsonable", "executor_class": {"__class__": "Executor",
            "__module__": "tfx.components.statistics_gen.executor",
            "__tfx_object_type__": "class"}}
          - '--inputs'
          - >-
            {"input_data": [{"artifact": {"properties": {"split":
            {"stringValue": "train"}, "producer_component": {"stringValue":
            "CsvExampleGen"}, "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "examples"}, "type_name": {"stringValue": "ExamplesPath"}}},
            "artifact_type": {"name": "ExamplesPath", "properties": {"split":
            "STRING", "name": "STRING", "type_name": "STRING", "state":
            "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING"}}}, {"artifact": {"properties":
            {"producer_component": {"stringValue": "CsvExampleGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "examples"}, "type_name": {"stringValue": "ExamplesPath"}, "split":
            {"stringValue": "eval"}}}, "artifact_type": {"name": "ExamplesPath",
            "properties": {"split": "STRING", "name": "STRING", "type_name":
            "STRING", "state": "STRING", "producer_component": "STRING", "span":
            "INT", "pipeline_name": "STRING"}}}]}
          - '--outputs'
          - >-
            {"output": [{"artifact": {"properties": {"split": {"stringValue":
            "train"}, "producer_component": {"stringValue": "StatisticsGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "output"}, "type_name": {"stringValue": "ExampleStatisticsPath"}}},
            "artifact_type": {"name": "ExampleStatisticsPath", "properties":
            {"state": "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING", "split": "STRING", "name": "STRING",
            "type_name": "STRING"}}}, {"artifact": {"properties":
            {"producer_component": {"stringValue": "StatisticsGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "output"}, "type_name": {"stringValue": "ExampleStatisticsPath"},
            "split": {"stringValue": "eval"}}}, "artifact_type": {"name":
            "ExampleStatisticsPath", "properties": {"name": "STRING",
            "type_name": "STRING", "state": "STRING", "producer_component":
            "STRING", "span": "INT", "pipeline_name": "STRING", "split":
            "STRING"}}}]}
          - '--exec_properties'
          - '{}'
        command:
          - python
          - /tfx-src/tfx/orchestration/kubeflow/container_entrypoint.py
        env:
          - name: WORKFLOW_ID
            valueFrom:
              fieldRef:
                fieldPath: 'metadata.labels[''workflows.argoproj.io/workflow'']'
        image: 'tensorflow/tfx:0.14.0'
        volumeMounts:
          - mountPath: /book-classification
            name: book-classification
      name: statisticsgen
      outputs:
        artifacts:
          - name: mlpipeline-ui-metadata
            path: /mlpipeline-ui-metadata.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-ui-metadata.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
          - name: mlpipeline-metrics
            path: /mlpipeline-metrics.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-metrics.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
    - container:
        args:
          - '--pipeline_name'
          - complaint_model_pipeline_kubeflow
          - '--pipeline_root'
          - /book-classification/tfx
          - '--kubeflow_metadata_config'
          - |-
            {
              "mysqlDbServiceHost": {
                "environmentVariable": "METADATA_DB_SERVICE_HOST"
              },
              "mysqlDbServicePort": {
                "environmentVariable": "METADATA_DB_SERVICE_PORT"
              },
              "mysqlDbName": {
                "value": "metadb"
              },
              "mysqlDbUser": {
                "value": "root"
              },
              "mysqlDbPassword": {
                "value": "test"
              }
            }
          - '--additional_pipeline_args'
          - >-
            {"beam_pipeline_args": ["--runner=DirectRunner",
            "--experiments=shuffle_mode=auto",
            "--temp_location=/book-classification/tmp"]}
          - '--component_id'
          - Trainer
          - '--component_type'
          - tfx.components.trainer.component.Trainer
          - '--driver_class_path'
          - tfx.components.trainer.driver.Driver
          - '--executor_spec'
          - >-
            {"__class__": "ExecutorClassSpec", "__module__":
            "tfx.components.base.executor_spec", "__tfx_object_type__":
            "jsonable", "executor_class": {"__class__": "Executor",
            "__module__": "tfx.components.trainer.executor",
            "__tfx_object_type__": "class"}}
          - '--inputs'
          - >-
            {"examples": [{"artifact": {"properties": {"split": {"stringValue":
            "train"}, "producer_component": {"stringValue": "Transform"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "transformed_examples"}, "type_name": {"stringValue":
            "ExamplesPath"}}}, "artifact_type": {"name": "ExamplesPath",
            "properties": {"split": "STRING", "name": "STRING", "type_name":
            "STRING", "state": "STRING", "producer_component": "STRING", "span":
            "INT", "pipeline_name": "STRING"}}}, {"artifact": {"properties":
            {"name": {"stringValue": "transformed_examples"}, "type_name":
            {"stringValue": "ExamplesPath"}, "split": {"stringValue": "eval"},
            "producer_component": {"stringValue": "Transform"}, "pipeline_name":
            {"stringValue": "complaint_model_pipeline_kubeflow"}}},
            "artifact_type": {"name": "ExamplesPath", "properties": {"state":
            "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING", "split": "STRING", "name": "STRING",
            "type_name": "STRING"}}}], "transform_output": [{"artifact":
            {"properties": {"type_name": {"stringValue": "TransformPath"},
            "split": {"stringValue": ""}, "producer_component": {"stringValue":
            "Transform"}, "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "transform_output"}}}, "artifact_type": {"name": "TransformPath",
            "properties": {"split": "STRING", "name": "STRING", "type_name":
            "STRING", "state": "STRING", "producer_component": "STRING", "span":
            "INT", "pipeline_name": "STRING"}}}], "schema": [{"artifact":
            {"properties": {"producer_component": {"stringValue": "SchemaGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "output"}, "type_name": {"stringValue": "SchemaPath"}, "split":
            {"stringValue": ""}}}, "artifact_type": {"name": "SchemaPath",
            "properties": {"type_name": "STRING", "state": "STRING",
            "producer_component": "STRING", "span": "INT", "pipeline_name":
            "STRING", "split": "STRING", "name": "STRING"}}}]}
          - '--outputs'
          - >-
            {"output": [{"artifact": {"properties": {"name": {"stringValue":
            "output"}, "type_name": {"stringValue": "ModelExportPath"}, "split":
            {"stringValue": ""}, "producer_component": {"stringValue":
            "Trainer"}, "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}}}, "artifact_type": {"name":
            "ModelExportPath", "properties": {"state": "STRING",
            "producer_component": "STRING", "span": "INT", "pipeline_name":
            "STRING", "split": "STRING", "name": "STRING", "type_name":
            "STRING"}}}]}
          - '--exec_properties'
          - >-
            {"train_args": "{\n  \"numSteps\": 10000\n}", "eval_args": "{\n 
            \"numSteps\": 5000\n}", "module_file":
            "/book-classification/tfx/utils.py", "trainer_fn": null,
            "custom_config": null}
        command:
          - python
          - /tfx-src/tfx/orchestration/kubeflow/container_entrypoint.py
        env:
          - name: WORKFLOW_ID
            valueFrom:
              fieldRef:
                fieldPath: 'metadata.labels[''workflows.argoproj.io/workflow'']'
        image: 'tensorflow/tfx:0.14.0'
        volumeMounts:
          - mountPath: /book-classification
            name: book-classification
      name: trainer
      outputs:
        artifacts:
          - name: mlpipeline-ui-metadata
            path: /mlpipeline-ui-metadata.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-ui-metadata.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
          - name: mlpipeline-metrics
            path: /mlpipeline-metrics.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-metrics.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
    - container:
        args:
          - '--pipeline_name'
          - complaint_model_pipeline_kubeflow
          - '--pipeline_root'
          - /book-classification/tfx
          - '--kubeflow_metadata_config'
          - |-
            {
              "mysqlDbServiceHost": {
                "environmentVariable": "METADATA_DB_SERVICE_HOST"
              },
              "mysqlDbServicePort": {
                "environmentVariable": "METADATA_DB_SERVICE_PORT"
              },
              "mysqlDbName": {
                "value": "metadb"
              },
              "mysqlDbUser": {
                "value": "root"
              },
              "mysqlDbPassword": {
                "value": "test"
              }
            }
          - '--additional_pipeline_args'
          - >-
            {"beam_pipeline_args": ["--runner=DirectRunner",
            "--experiments=shuffle_mode=auto",
            "--temp_location=/book-classification/tmp"]}
          - '--component_id'
          - Transform
          - '--component_type'
          - tfx.components.transform.component.Transform
          - '--driver_class_path'
          - tfx.components.base.base_driver.BaseDriver
          - '--executor_spec'
          - >-
            {"__class__": "ExecutorClassSpec", "__module__":
            "tfx.components.base.executor_spec", "__tfx_object_type__":
            "jsonable", "executor_class": {"__class__": "Executor",
            "__module__": "tfx.components.transform.executor",
            "__tfx_object_type__": "class"}}
          - '--inputs'
          - >-
            {"input_data": [{"artifact": {"properties": {"split":
            {"stringValue": "train"}, "producer_component": {"stringValue":
            "CsvExampleGen"}, "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "examples"}, "type_name": {"stringValue": "ExamplesPath"}}},
            "artifact_type": {"name": "ExamplesPath", "properties": {"split":
            "STRING", "name": "STRING", "type_name": "STRING", "state":
            "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING"}}}, {"artifact": {"properties":
            {"producer_component": {"stringValue": "CsvExampleGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "examples"}, "type_name": {"stringValue": "ExamplesPath"}, "split":
            {"stringValue": "eval"}}}, "artifact_type": {"name": "ExamplesPath",
            "properties": {"split": "STRING", "name": "STRING", "type_name":
            "STRING", "state": "STRING", "producer_component": "STRING", "span":
            "INT", "pipeline_name": "STRING"}}}], "schema": [{"artifact":
            {"properties": {"producer_component": {"stringValue": "SchemaGen"},
            "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "output"}, "type_name": {"stringValue": "SchemaPath"}, "split":
            {"stringValue": ""}}}, "artifact_type": {"name": "SchemaPath",
            "properties": {"type_name": "STRING", "state": "STRING",
            "producer_component": "STRING", "span": "INT", "pipeline_name":
            "STRING", "split": "STRING", "name": "STRING"}}}]}
          - '--outputs'
          - >-
            {"transform_output": [{"artifact": {"properties": {"type_name":
            {"stringValue": "TransformPath"}, "split": {"stringValue": ""},
            "producer_component": {"stringValue": "Transform"}, "pipeline_name":
            {"stringValue": "complaint_model_pipeline_kubeflow"}, "name":
            {"stringValue": "transform_output"}}}, "artifact_type": {"name":
            "TransformPath", "properties": {"split": "STRING", "name": "STRING",
            "type_name": "STRING", "state": "STRING", "producer_component":
            "STRING", "span": "INT", "pipeline_name": "STRING"}}}],
            "transformed_examples": [{"artifact": {"properties": {"split":
            {"stringValue": "train"}, "producer_component": {"stringValue":
            "Transform"}, "pipeline_name": {"stringValue":
            "complaint_model_pipeline_kubeflow"}, "name": {"stringValue":
            "transformed_examples"}, "type_name": {"stringValue":
            "ExamplesPath"}}}, "artifact_type": {"name": "ExamplesPath",
            "properties": {"split": "STRING", "name": "STRING", "type_name":
            "STRING", "state": "STRING", "producer_component": "STRING", "span":
            "INT", "pipeline_name": "STRING"}}}, {"artifact": {"properties":
            {"name": {"stringValue": "transformed_examples"}, "type_name":
            {"stringValue": "ExamplesPath"}, "split": {"stringValue": "eval"},
            "producer_component": {"stringValue": "Transform"}, "pipeline_name":
            {"stringValue": "complaint_model_pipeline_kubeflow"}}},
            "artifact_type": {"name": "ExamplesPath", "properties": {"state":
            "STRING", "producer_component": "STRING", "span": "INT",
            "pipeline_name": "STRING", "split": "STRING", "name": "STRING",
            "type_name": "STRING"}}}]}
          - '--exec_properties'
          - >-
            {"module_file": "/book-classification/tfx/utils.py",
            "preprocessing_fn": null}
        command:
          - python
          - /tfx-src/tfx/orchestration/kubeflow/container_entrypoint.py
        env:
          - name: WORKFLOW_ID
            valueFrom:
              fieldRef:
                fieldPath: 'metadata.labels[''workflows.argoproj.io/workflow'']'
        image: 'tensorflow/tfx:0.14.0'
        volumeMounts:
          - mountPath: /book-classification
            name: book-classification
      name: transform
      outputs:
        artifacts:
          - name: mlpipeline-ui-metadata
            path: /mlpipeline-ui-metadata.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-ui-metadata.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
          - name: mlpipeline-metrics
            path: /mlpipeline-metrics.json
            s3:
              accessKeySecret:
                key: accesskey
                name: mlpipeline-minio-artifact
              bucket: mlpipeline
              endpoint: 'minio-service.kubeflow:9000'
              insecure: true
              key: 'runs/{{workflow.uid}}/{{pod.name}}/mlpipeline-metrics.tgz'
              secretKeySecret:
                key: secretkey
                name: mlpipeline-minio-artifact
  volumes:
    - name: book-classification
      persistentVolumeClaim:
        claimName: book-classification-claim
